<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Harmony Music Player - Working</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma, Geneva, Verdana, sans-serif;}
body{background:linear-gradient(135deg,#1a1a2e,#16213e,#0f3460);color:#fff;min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px;}
.music-player{background:rgba(30,30,46,0.8);backdrop-filter:blur(10px);border-radius:20px;box-shadow:0 15px 30px rgba(0,0,0,0.4);width:100%;max-width:400px;padding:25px;text-align:center;transition:all .3s ease;}
.player-header{margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;}
.player-header h1{font-size:24px;color:#e94560;display:flex;align-items:center;gap:10px;}
.player-header p{color:#8a8a9a;font-size:14px;}
.album-art{width:220px;height:220px;margin:0 auto 25px;border-radius:50%;overflow:hidden;box-shadow:0 10px 20px rgba(0,0,0,0.3);border:5px solid #2d3047;position:relative;animation:rotate 20s linear infinite;animation-play-state:paused;}
.album-art.playing{animation-play-state:running;}
@keyframes rotate{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
.album-art img{width:100%;height:100%;object-fit:cover;}
.album-art::after{content:'';position:absolute;width:30px;height:30px;background:#2d3047;border-radius:50%;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2;}
.song-info{margin-bottom:25px;}
.song-title{font-size:22px;margin-bottom:5px;color:#fff;}
.artist{font-size:16px;color:#e94560;}
.progress-area{margin-bottom:25px;}
.progress-bar{height:6px;width:100%;background:rgba(255,255,255,0.1);border-radius:10px;cursor:pointer;margin-bottom:5px;position:relative;}
.progress{height:100%;width:0%;background:#e94560;border-radius:10px;position:relative;transition:width .1s linear;}
.progress::after{content:'';position:absolute;height:12px;width:12px;background:#fff;border-radius:50%;right:-5px;top:50%;transform:translateY(-50%);box-shadow:0 0 5px rgba(0,0,0,0.4);}
.timer{display:flex;justify-content:space-between;font-size:13px;color:#8a8a9a;}
.controls{display:flex;justify-content:center;align-items:center;margin-bottom:25px;}
.controls button{border:none;background:none;color:#fff;font-size:18px;cursor:pointer;padding:10px;margin:0 10px;border-radius:50%;transition:all .3s;display:flex;align-items:center;justify-content:center;}
.controls button:hover{background:rgba(255,255,255,0.1);}
.play-pause{width:60px;height:60px;background:#e94560;display:flex;justify-content:center;align-items:center;border-radius:50%;font-size:22px;}
.play-pause:hover{transform:scale(1.05);background:#ff5773;}
.volume-control{display:flex;align-items:center;margin-bottom:20px;}
.volume-control i{margin-right:10px;color:#8a8a9a;}
.volume-slider{width:100%;height:5px;background:rgba(255,255,255,0.1);border-radius:10px;cursor:pointer;position:relative;}
.volume-percent{height:100%;width:50%;background:#e94560;border-radius:10px;}
.playlist{max-height:200px;overflow-y:auto;margin-top:20px;border-top:1px solid rgba(255,255,255,0.1);padding-top:15px;}
.playlist h3{ text-align:left;margin-bottom:10px;color:#e94560;font-size:18px;display:flex;align-items:center;gap:8px;}
.playlist-item{display:flex;align-items:center;padding:10px;border-radius:10px;margin-bottom:8px;cursor:pointer;transition:all .3s;}
.playlist-item:hover{background:rgba(255,255,255,0.1);}
.playlist-item.active{background:rgba(233,69,96,0.2);border-left:3px solid #e94560;}
.playlist-item img{width:40px;height:40px;border-radius:5px;margin-right:15px;}
.playlist-info{text-align:left;flex-grow:1;}
.playlist-title{font-size:14px;color:#fff;}
.playlist-artist{font-size:12px;color:#8a8a9a;}
.playlist-duration{font-size:12px;color:#8a8a9a;}
.playlist::-webkit-scrollbar{width:6px;}
.playlist::-webkit-scrollbar-track{background:rgba(255,255,255,0.1);border-radius:10px;}
.playlist::-webkit-scrollbar-thumb{background:#e94560;border-radius:10px;}
.autoplay-toggle{display:flex;justify-content:space-between;align-items:center;margin-top:15px;padding-top:15px;border-top:1px solid rgba(255,255,255,0.1);}
.toggle-label{font-size:14px;color:#8a8a9a;}
.toggle-switch{position:relative;display:inline-block;width:50px;height:24px;}
.toggle-switch input{opacity:0;width:0;height:0;}
.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:rgba(255,255,255,0.1);transition:.4s;border-radius:34px;}
.slider:before{position:absolute;content:"";height:16px;width:16px;left:4px;bottom:4px;background-color:white;transition:.4s;border-radius:50%;}
input:checked + .slider{background-color:#e94560;}
input:checked + .slider:before{transform:translateX(26px);}
.song-count{color:#8a8a9a;font-size:12px;margin-top:5px;text-align:left;}
.loading{color:#8a8a9a;font-size:14px;margin-top:10px;}
</style>
</head>
<body>
<div class="music-player">
  <div class="player-header">
    <h1><i class="fas fa-music"></i> Harmony Player</h1>
    <p>Enjoy your favorite tunes</p>
  </div>

  <div class="album-art" id="album-art">
    <img id="album-image" src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=500&q=60" alt="Album Art">
  </div>
  <div class="song-info">
    <h2 class="song-title" id="song-title">—</h2>
    <p class="artist" id="artist">—</p>
  </div>
  <div class="progress-area">
    <div class="progress-bar" id="progress-bar">
      <div class="progress" id="progress"></div>
    </div>
    <div class="timer">
      <span id="current-time">0:00</span>
      <span id="duration">0:00</span>
    </div>
  </div>
  <div class="controls">
    <button id="shuffle"><i class="fas fa-random"></i></button>
    <button id="prev"><i class="fas fa-step-backward"></i></button>
    <button class="play-pause" id="play-pause"><i class="fas fa-play" id="play-icon"></i></button>
    <button id="next"><i class="fas fa-step-forward"></i></button>
    <button id="repeat"><i class="fas fa-redo"></i></button>
  </div>
  <div class="volume-control">
    <i class="fas fa-volume-up"></i>
    <div class="volume-slider" id="volume-slider">
      <div class="volume-percent" id="volume-percent"></div>
    </div>
  </div>
  <div class="autoplay-toggle">
    <span class="toggle-label">Autoplay</span>
    <label class="toggle-switch">
      <input type="checkbox" id="autoplay-toggle">
      <span class="slider"></span>
    </label>
  </div>
  <div class="playlist">
    <h3><i class="fas fa-list"></i> Playlist</h3>
    <div class="song-count" id="song-count">0 songs</div>
    <div id="playlist-container"></div>
  </div>
<div class="loading" id="loading-message">Click Play to start listening</div>
</div>
<script>
const songs = [
  {
    title: "Dreams",
    artist: "Bensound",
    src: "https://www.bensound.com/bensound-music/bensound-dreams.mp3",
    cover: "https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=500&q=60"
  },
  {
    title: "Energy",
    artist: "Bensound",
    src: "https://www.bensound.com/bensound-music/bensound-energy.mp3",
    cover: "https://images.unsplash.com/photo-1470225620780-dba8ba36b745?auto=format&fit=crop&w=500&q=60"
  },
  {
    title: "Sunny",
    artist: "Bensound",
    src: "https://www.bensound.com/bensound-music/bensound-sunny.mp3",
    cover: "https://images.unsplash.com/photo-1511379938547-c1f69419868d?auto=format&fit=crop&w=500&q=60"
  }
];
const audio = new Audio();
const playPauseBtn = document.getElementById('play-pause');
const playIcon = document.getElementById('play-icon');
const prevBtn = document.getElementById('prev');
const nextBtn = document.getElementById('next');
const shuffleBtn = document.getElementById('shuffle');
const repeatBtn = document.getElementById('repeat');
const songTitle = document.getElementById('song-title');
const artist = document.getElementById('artist');
const albumImage = document.getElementById('album-image');
const albumArt = document.getElementById('album-art');
const progressBar = document.getElementById('progress-bar');
const progress = document.getElementById('progress');
const currentTimeEl = document.getElementById('current-time');
const durationEl = document.getElementById('duration');
const volumeSlider = document.getElementById('volume-slider');
const volumePercent = document.getElementById('volume-percent');
const playlistContainer = document.getElementById('playlist-container');
const autoplayToggle = document.getElementById('autoplay-toggle');
const loadingMessage = document.getElementById('loading-message');
const songCountEl = document.getElementById('song-count');
let currentSongIndex = 0;
let isPlaying = false;
let isAutoplay = false;
let isShuffled = false;
let isRepeating = false;
function initPlayer() {
  renderPlaylist();
  loadSong(currentSongIndex);
  audio.volume = 0.5;
  updateVolumeUI();
  playPauseBtn.addEventListener('click', togglePlayPause);
  prevBtn.addEventListener('click', playPrevious);
  nextBtn.addEventListener('click', playNext);
  shuffleBtn.addEventListener('click', toggleShuffle);
  repeatBtn.addEventListener('click', toggleRepeat);
  progressBar.addEventListener('click', setProgress);
  volumeSlider.addEventListener('click', setVolume);
  audio.addEventListener('timeupdate', updateProgress);
  audio.addEventListener('ended', handleSongEnd);
  audio.addEventListener('canplaythrough', () => {
    loadingMessage.textContent = "Ready to play";
    if (audio.duration && !isNaN(audio.duration)) {
      durationEl.textContent = formatTime(audio.duration);
    }
  });
  audio.addEventListener('waiting', () => loadingMessage.textContent = "Loading...");
  autoplayToggle.addEventListener('change', toggleAutoplay);
}
function loadSong(index) {
  const song = songs[index];
  songTitle.textContent = song.title;
  artist.textContent = song.artist;
  albumImage.src = song.cover;
  audio.src = song.src;

  progress.style.width = '0%';
  currentTimeEl.textContent = '0:00';
  durationEl.textContent = '0:00';
  loadingMessage.textContent = "Loading song...";

  updateActiveSong();

  if (isPlaying) {
    playSong();
  }
}
function togglePlayPause() {
  if (isPlaying) pauseSong();
  else playSong();
}
function playSong() {
  isPlaying = true;
  playIcon.classList.remove('fa-play');
  playIcon.classList.add('fa-pause');
  albumArt.classList.add('playing');
  audio.play().then(() => {
    loadingMessage.textContent = "Now playing";
  }).catch(err => {
    console.warn("Play error:", err);
    loadingMessage.textContent = "Playback blocked. Click play.";
    isPlaying = false;
    playIcon.classList.remove('fa-pause');
    playIcon.classList.add('fa-play');
    albumArt.classList.remove('playing');
  });
}
function pauseSong() {
  isPlaying = false;
  playIcon.classList.remove('fa-pause');
  playIcon.classList.add('fa-play');
  albumArt.classList.remove('playing');
  audio.pause();
  loadingMessage.textContent = "Paused";
}
function playPrevious() {
  currentSongIndex--;
  if (currentSongIndex < 0) currentSongIndex = songs.length - 1;
  loadSong(currentSongIndex);
}
function playNext() {
  if (isShuffled) {
    let randomIndex;
    do { randomIndex = Math.floor(Math.random() * songs.length); }
    while (randomIndex === currentSongIndex && songs.length > 1);
    currentSongIndex = randomIndex;
  } else {
    currentSongIndex++;
    if (currentSongIndex > songs.length - 1) currentSongIndex = 0;
  }
  loadSong(currentSongIndex);
}
function toggleShuffle(){ isShuffled = !isShuffled; shuffleBtn.style.color = isShuffled ? '#e94560' : '#fff'; }
function toggleRepeat(){ isRepeating = !isRepeating; repeatBtn.style.color = isRepeating ? '#e94560' : '#fff'; }
function updateProgress(){
  if (audio.duration) {
    const progressPercent = (audio.currentTime / audio.duration) * 100;
    progress.style.width = `${progressPercent}%`;
    currentTimeEl.textContent = formatTime(audio.currentTime);
    durationEl.textContent = formatTime(audio.duration);
  }
}
function setProgress(e){
  const width = this.clientWidth;
  const clickX = e.offsetX;
  const duration = audio.duration;
  if (duration) audio.currentTime = (clickX / width) * duration;
}
function setVolume(e){
  const width = this.clientWidth;
  const clickX = e.offsetX;
  const volume = clickX / width;
  audio.volume = Math.min(Math.max(volume, 0), 1);
  updateVolumeUI();
}
function updateVolumeUI(){ volumePercent.style.width = `${audio.volume * 100}%`; }
function formatTime(seconds){
  let min = Math.floor(seconds / 60);
  let sec = Math.floor(seconds % 60);
  return `${min}:${sec < 10 ? '0' : ''}${sec}`;
}
function renderPlaylist(){
  playlistContainer.innerHTML = '';
  songs.forEach((song, index) => {
    const item = document.createElement('div');
    item.classList.add('playlist-item');
    if (index === currentSongIndex) item.classList.add('active');
    item.innerHTML = `<img src="${song.cover}" alt="${song.title}">
      <div class="playlist-info">
        <div class="playlist-title">${song.title}</div>
        <div class="playlist-artist">${song.artist}</div>
      </div>
    `;
    item.addEventListener('click', () => {
      currentSongIndex = index;
      loadSong(currentSongIndex);
      playSong();
    });
    playlistContainer.appendChild(item);
  });
  songCountEl.textContent = `${songs.length} songs`;
}
function updateActiveSong(){
  const items = document.querySelectorAll('.playlist-item');
  items.forEach((it, idx) => {
    it.classList.toggle('active', idx === currentSongIndex);
  });
}
function handleSongEnd(){
  if (isRepeating) {
    audio.currentTime = 0;
    audio.play();
  } else if (isAutoplay) {
    playNext();
    playSong();
  } else {
    pauseSong();
  }
}
function toggleAutoplay(){ isAutoplay = autoplayToggle.checked; }
window.addEventListener('load', initPlayer);
</script>
</body>
</html>